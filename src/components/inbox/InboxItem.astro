---
import CheckSquare from "~icons/lucide/check-square";
import FileText from "~icons/lucide/file-text";
import Link from "~icons/lucide/link";
import Lightbulb from "~icons/lucide/lightbulb";
import BookOpen from "~icons/lucide/book-open";
import InboxIcon from "~icons/lucide/inbox";
import ArrowRight from "~icons/lucide/arrow-right";

interface Props {
    item: {
        id: string;
        data: {
            title: string;
            type?: string;
            captured: Date;
        };
    };
}

const { item } = Astro.props;

const typeIcons = {
    action: CheckSquare,
    note: FileText,
    link: Link,
    idea: Lightbulb,
    resource: BookOpen,
};

const Icon = typeIcons[item.data.type as keyof typeof typeIcons] || InboxIcon;
---

<div class="inbox-item group" data-id={item.id}>
    <label
        class="flex items-start gap-4 p-5 bg-surface border border-border rounded-lg hover:border-primary/50 hover:shadow-md transition-all cursor-pointer"
    >
        <input
            type="checkbox"
            class="inbox-checkbox mt-1 w-4 h-4 text-primary bg-surface border-border rounded focus:ring-primary focus:ring-2"
            value={item.id}
        />
        <div class="flex-1 min-w-0">
            <a href={`/inbox/${item.id}`} class="block">
                <p
                    class="text-lg font-semibold group-hover:text-primary transition-colors truncate"
                >
                    {item.data.title}
                </p>
            </a>
            <div class="mt-2 flex items-center gap-3 text-sm text-text-muted">
                <span
                    class:list={[
                        "px-2 py-0.5 rounded text-xs font-medium uppercase tracking-wider flex items-center gap-1",
                        item.data.type
                            ? "bg-primary/10 text-primary"
                            : "bg-surface-hover text-text-muted",
                    ]}
                >
                    <Icon class="h-3 w-3" />
                    {item.data.type || "Unsorted"}
                </span>
                <span>
                    Captured {
                        new Date(item.data.captured).toLocaleDateString(undefined, {
                            dateStyle: "medium",
                        })
                    }
                </span>
            </div>
        </div>
        <a
            href={`/triage/${item.id}`}
            class="triage-button p-2 text-text-muted hover:text-primary hover:bg-surface-hover rounded-full transition-all shrink-0"
            title="Triage this item"
        >
            <ArrowRight class="h-5 w-5" />
        </a>
    </label>
</div>
