---
import { dataReader } from "../lib/data/reader";
import AppLayout from "../layouts/AppLayout.astro";
import Heading from "../components/ui/Heading.astro";
import Card from "../components/ui/Card.astro";

const { currentUser } = Astro.locals as any;

// Get data for dashboard
const inboxItems = await dataReader.getInboxItems(currentUser);
const areas = await dataReader.getAreas(currentUser);
const projects = await dataReader.getAllProjects(currentUser);
const actions = await dataReader.getAllActions(currentUser);
const reviews = await dataReader.getReviews(currentUser);
---

<AppLayout title="Dashboard | Action Amplifier">
    <Heading level={1} class="mb-8">Dashboard</Heading>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
        <Card class="p-6 bg-surface/50">
            <Heading level={3} class="text-lg font-medium text-text-muted mb-2"
                >Inbox</Heading
            >
            <p class="text-4xl font-bold text-primary">{inboxItems.length}</p>
        </Card>
        <Card class="p-6 bg-surface/50">
            <Heading level={3} class="text-lg font-medium text-text-muted mb-2"
                >Areas</Heading
            >
            <p class="text-4xl font-bold text-primary">{areas.length}</p>
        </Card>
        <Card class="p-6 bg-surface/50">
            <Heading level={3} class="text-lg font-medium text-text-muted mb-2"
                >Projects</Heading
            >
            <p class="text-4xl font-bold text-primary">{projects.length}</p>
        </Card>
        <Card class="p-6 bg-surface/50">
            <Heading level={3} class="text-lg font-medium text-text-muted mb-2"
                >Actions</Heading
            >
            <p class="text-4xl font-bold text-primary">{actions.length}</p>
        </Card>
    </div>

    <Card class="p-6">
        <Heading level={2} class="mb-4">Debug Data</Heading>
        <pre
            class="bg-black/50 p-4 rounded-lg overflow-auto h-64 text-xs font-mono text-text-muted">
            {JSON.stringify({ inboxItems, areas, projects, actions }, null, 2)}
        </pre>
    </Card>
</AppLayout>
